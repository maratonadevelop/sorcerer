@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Cinzel+Decorative:wght@400;700&family=Cinzel:wght@400;500;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap');
@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  /* DARKER THEME: reduce lightness for a deeper charcoal/graphite feel */
  --background: hsl(220, 25%, 5%); /* was 8% */
  --foreground: hsl(45, 20%, 90%);
  --card: hsl(220, 25%, 8%); /* was 12% */
  --card-foreground: hsl(45, 15%, 85%);
  --popover: hsl(220, 25%, 8%); /* was 12% */
  --popover-foreground: hsl(45, 15%, 85%);
  --primary: hsl(45, 90%, 65%);
  --primary-foreground: hsl(220, 25%, 8%);
  /* Make secondary a complementary gold tone so existing `bg-secondary` buttons become golden */
  --secondary: hsl(42, 85%, 45%);
  --secondary-foreground: hsl(220, 25%, 8%);
  --muted: hsl(220, 20%, 10%); /* was 15% */
  --muted-foreground: hsl(45, 10%, 70%);
  --accent: hsl(30, 40%, 45%);
  --accent-foreground: hsl(45, 20%, 90%);
  --destructive: hsl(0, 65%, 50%);
  --destructive-foreground: hsl(45, 20%, 90%);
  --border: hsl(220, 15%, 12%); /* slightly darker border */
  --input: hsl(220, 15%, 12%);
  --ring: hsl(45, 90%, 65%);
  --chart-1: hsl(45, 90%, 65%);
  --chart-2: hsl(159.7826, 100%, 36.0784%);
  --chart-3: hsl(42.0290, 92.8251%, 56.2745%);
  --chart-4: hsl(147.1429, 78.5047%, 41.9608%);
  --chart-5: hsl(341.4894, 75.2000%, 50.9804%);
  --sidebar: hsl(220, 25%, 8%);
  --sidebar-foreground: hsl(45, 15%, 85%);
  --sidebar-primary: hsl(45, 90%, 65%);
  --sidebar-primary-foreground: hsl(220, 25%, 8%);
  --sidebar-accent: hsl(30, 40%, 45%);
  --sidebar-accent-foreground: hsl(45, 20%, 90%);
  --sidebar-border: hsl(220, 15%, 20%);
  --sidebar-ring: hsl(45, 90%, 65%);
  --font-display: 'Cinzel', serif;
  --font-body: 'Crimson Text', serif;
  --font-sans: 'Crimson Text', serif;
  --font-serif: 'Crimson Text', serif;
  --font-map: 'Cinzel Decorative', 'Cinzel', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
  --font-mono: 'Fira Code', monospace;
  --reader-font-size: 16px;
  --reader-line-height: 1.85;
  --radius: 0.75rem;
}

.dark {
  /* Mirror darker tokens for explicit .dark class as well */
  --background: hsl(220, 25%, 5%);
  --foreground: hsl(45, 20%, 90%);
  --card: hsl(220, 25%, 8%);
  --card-foreground: hsl(45, 15%, 85%);
  --popover: hsl(220, 25%, 8%);
  --popover-foreground: hsl(45, 15%, 85%);
  --primary: hsl(45, 90%, 65%);
  --primary-foreground: hsl(220, 25%, 8%);
  --secondary: hsl(260, 50%, 25%);
  --secondary-foreground: hsl(45, 20%, 90%);
  --muted: hsl(220, 20%, 10%);
  --muted-foreground: hsl(45, 10%, 70%);
  --accent: hsl(30, 40%, 45%);
  --accent-foreground: hsl(45, 20%, 90%);
  --destructive: hsl(0, 65%, 50%);
  --destructive-foreground: hsl(45, 20%, 90%);
  --border: hsl(220, 15%, 12%);
  --input: hsl(220, 15%, 12%);
  --ring: hsl(45, 90%, 65%);
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply font-body antialiased bg-background text-foreground;
  /* prevent horizontal scrollbar when using full-bleed videos */
  overflow-x: hidden;
  }
}

@layer utilities {
  .font-display {
    font-family: var(--font-display);
  }
  
  .font-body {
    font-family: var(--font-body);
  }

  /* Standardized rich-content typography for reading (chapters/codex/blog/etc)
     - body text slightly gray
     - bold text closer to white
     - ignores inline pasted font/color/size so everything matches the default style */
  .content-prose {
    font-size: var(--reader-font-size);
    line-height: var(--reader-line-height);
    color: var(--muted-foreground);
    --tw-prose-body: var(--muted-foreground);
    --tw-prose-invert-body: var(--muted-foreground);
    --tw-prose-headings: var(--foreground);
    --tw-prose-invert-headings: var(--foreground);
    --tw-prose-lead: var(--foreground);
    --tw-prose-invert-lead: var(--foreground);
    --tw-prose-links: var(--primary);
    --tw-prose-invert-links: var(--primary);
    --tw-prose-bold: var(--foreground);
    --tw-prose-invert-bold: var(--foreground);
    --tw-prose-counters: var(--muted-foreground);
    --tw-prose-invert-counters: var(--muted-foreground);
    --tw-prose-bullets: var(--muted-foreground);
    --tw-prose-invert-bullets: var(--muted-foreground);
    --tw-prose-hr: var(--border);
    --tw-prose-invert-hr: var(--border);
    --tw-prose-quotes: var(--foreground);
    --tw-prose-invert-quotes: var(--foreground);
    --tw-prose-quote-borders: var(--border);
    --tw-prose-invert-quote-borders: var(--border);
    --tw-prose-captions: var(--muted-foreground);
    --tw-prose-invert-captions: var(--muted-foreground);
    --tw-prose-code: var(--foreground);
    --tw-prose-invert-code: var(--foreground);
    --tw-prose-pre-code: var(--foreground);
    --tw-prose-invert-pre-code: var(--foreground);
    --tw-prose-pre-bg: var(--muted);
    --tw-prose-invert-pre-bg: var(--muted);
    --tw-prose-th-borders: var(--border);
    --tw-prose-invert-th-borders: var(--border);
    --tw-prose-td-borders: var(--border);
    --tw-prose-invert-td-borders: var(--border);
  }

  .content-prose :where([style*="font-family" i]) { font-family: inherit !important; }
  .content-prose :where([style*="font-size" i]) { font-size: inherit !important; }
  .content-prose :where([style*="color" i]) { color: inherit !important; }

  /* Force default (non-bold) text to remain muted gray in reading view.
     Some typography styles can still push a lighter color under `prose-invert`. */
  .content-prose :where(p, li, blockquote, figcaption) { color: var(--muted-foreground) !important; }

  .content-prose :where(strong, b) { color: var(--foreground) !important; }
  .content-prose :where(h1, h2, h3, h4, h5, h6) {
    color: var(--foreground) !important;
    font-size: inherit !important;
    line-height: inherit !important;
    margin: 0 0 1em 0 !important;
    font-weight: 700 !important;
  }
  .content-prose :where(a) { color: var(--primary) !important; }
  
  .magical-gradient {
    background: linear-gradient(135deg, hsl(260, 50%, 25%) 0%, hsl(220, 25%, 8%) 50%, hsl(30, 40%, 15%) 100%);
  }

  /* Button variants: gold and muted (gray) */
  .btn-gold {
    background: linear-gradient(90deg, hsl(45, 90%, 65%) 0%, hsl(38, 80%, 52%) 60%);
    color: var(--primary-foreground);
    border: 1px solid rgba(255,200,120,0.12);
    box-shadow: 0 8px 30px rgba(255,180,70,0.12);
    text-shadow: 0 0 8px rgba(255,238,153,0.12);
  }

  .btn-gold:hover {
    box-shadow: 0 18px 48px rgba(255,180,70,0.18), 0 6px 18px rgba(255,160,50,0.06) inset;
    transform: translateY(-2px) scale(1.02);
  }

  /* Button font that pairs with the ornate gold — use display serif for a classic look */
  .btn-font {
    font-family: var(--font-display);
    letter-spacing: 0.6px;
    text-transform: none;
    font-weight: 600;
  }

  .btn-muted {
    background: var(--muted);
    color: var(--muted-foreground);
    border: 1px solid rgba(255,255,255,0.02);
    box-shadow: none;
    text-shadow: none;
  }

    /* Map card stat title hover glow */
    .map-stat-title {
      transition: color 200ms ease, text-shadow 200ms ease, transform 160ms ease;
    }
    .map-stat-title:hover {
      color: #ffe8a6;
      text-shadow: 0 0 18px rgba(255, 200, 75, 0.85), 0 2px 6px rgba(0,0,0,0.6);
      transform: translateY(-2px);
    }

    /* Interactive SVG map styles */
    .interactive-svg-wrapper {
      width: 100%;
      display: block;
    }
    .interactive-svg svg {
      width: 100%;
      height: auto;
      display: block;
    }
    .interactive-svg [data-continent] {
      transition: fill 180ms ease, opacity 180ms ease, filter 180ms ease;
      cursor: pointer;
    }
    .interactive-svg [data-continent].active {
      filter: drop-shadow(0 6px 18px rgba(255,200,80,0.45));
      opacity: 1 !important;
    }
    .map-tooltip { background: rgba(0,0,0,0.8); color: #fff; padding: 6px 8px; border-radius: 6px; font-size: 12px; }

  /* overlay badges removed; no-op */

    /* make svg continent groups transition opacity smoothly */
    .interactive-svg-wrapper svg g { transition: opacity 160ms ease; }
  /* selected vertex highlight */
  .interactive-svg-wrapper svg circle { transition: transform 100ms ease, fill 100ms ease; }
  /* preview points and polyline for multi-add */
  .interactive-svg-wrapper svg circle.preview { fill: #ffcc33; stroke: none; }
  .interactive-svg-wrapper svg polyline.preview { stroke: #ffcc33; stroke-width: 2px; stroke-dasharray: 6 4; fill: none; }

  .btn-muted:hover {
    transform: translateY(-1px);
    box-shadow: 0 6px 18px rgba(0,0,0,0.16) inset;
  }

  /* Alternate gold tone for secondary golden CTA (slightly cooler, greener) */
  .btn-gold-alt {
    background: linear-gradient(90deg, hsl(48, 78%, 58%) 0%, hsl(34, 70%, 44%) 60%);
    color: var(--primary-foreground);
    border: 1px solid rgba(220,200,140,0.10);
    box-shadow: 0 10px 36px rgba(200,180,90,0.10);
    text-shadow: 0 0 6px rgba(255,245,200,0.08);
  }

  .btn-gold-alt:hover {
    box-shadow: 0 20px 54px rgba(200,180,90,0.16), 0 6px 18px rgba(220,200,100,0.04) inset;
    transform: translateY(-2px) scale(1.02);
  }
  
  .text-shadow-gold {
    text-shadow: 0 0 10px hsl(45, 90%, 65%, 0.5);
  }
  
  .ornate-border {
    border-image: linear-gradient(45deg, hsl(45, 90%, 65%), hsl(30, 40%, 45%), hsl(45, 90%, 65%)) 1;
    border-style: solid;
    border-width: 2px;
  }
  
  .hover-glow {
    transition: all 0.3s ease;
  }
  
  .hover-glow:hover {
    box-shadow: 0 0 20px hsl(45, 90%, 65%, 0.24);
    transform: translateY(-2px);
  }
  
  /* no special focus outline beyond default ring utilities */
  
  .scroll-indicator {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: linear-gradient(to right, hsl(45, 90%, 65%), hsl(30, 40%, 45%));
    transform-origin: left;
    transform: scaleX(0);
    z-index: 1000;
  }
  
  @keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-10px); }
  }
  
  .floating {
    animation: float 6s ease-in-out infinite;
  }
  
  .chapter-card {
    position: relative;
    overflow: hidden;
  }
  
  .chapter-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, hsl(45, 90%, 65%, 0.1), transparent);
    transition: left 0.5s;
  }
  
  .chapter-card:hover::before {
    left: 100%;
  }

  /* Equal-height card helper for grid layouts */
  .card-equal { height: 520px; }
  @media (max-width: 640px) {
    .card-equal { height: 420px; }
  }

  /* Multi-line clamp for excerpts without plugin */
  .clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  .clamp-1 {
    display: -webkit-box;
    -webkit-line-clamp: 1;
    line-clamp: 1;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  /* Hero particles: subtle floating foreground particles with lightweight parallax */
  .hero-particles {
    position: absolute;
    inset: 0;
    pointer-events: none;
    overflow: hidden;
    z-index: 12;
    --parallax-x: 0;
    --parallax-y: 0;
  }
  .hero-particles .particle {
    position: absolute;
    border-radius: 50%;
    /* subtle moving glints */
    background: radial-gradient(circle at 35% 35%, rgba(255,245,200,0.95), rgba(255,200,80,0.55));
    filter: blur(1.6px);
    transform: translateZ(0) scale(1);
    transition: transform 420ms ease, opacity 420ms ease;
    mix-blend-mode: screen;
    will-change: transform, opacity;
    animation: particle-float var(--d, 8s) ease-in-out infinite;
  }

  @keyframes particle-float {
    0% { transform: translateY(6px) scale(0.96); opacity: 0.18; }
    40% { transform: translateY(-10px) scale(1.06); opacity: 0.9; }
    70% { transform: translateY(-18px) scale(1.02); opacity: 0.7; }
    100% { transform: translateY(6px) scale(0.98); opacity: 0.18; }
  }

  @media (prefers-reduced-motion: reduce) {
    .hero-particles .particle {
      transition: none;
      transform: none !important;
      filter: none;
      opacity: 0.06 !important;
      animation: none !important;
    }
  }

  /* no particle animation - removed to avoid horizontal/visual drift */
}

/* Navigation link hover effects: subtle glow, scale and bottom luminous bar */
.nav-link {
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 0.375rem;
  transition: transform 180ms cubic-bezier(.2,.9,.2,1), color 180ms ease, text-shadow 180ms ease;
}

.nav-link::after {
  content: '';
  position: absolute;
  left: 0;
  right: 0;
  bottom: -6px;
  height: 3px;
  background: linear-gradient(90deg, rgba(255,238,153,0.95), rgba(255,175,75,0.95));
  opacity: 0;
  transform: translateY(6px) scaleX(0.9);
  transition: opacity 200ms ease, transform 200ms ease;
  border-radius: 2px;
  box-shadow: 0 4px 12px rgba(255,200,120,0.08);
}

.nav-link:hover, .nav-link:focus {
  transform: translateY(-2px) scale(1.03);
  color: var(--primary);
  text-shadow: 0 0 10px rgba(255,238,153,0.16);
}

.nav-link:hover::after, .nav-link:focus::after {
  opacity: 1;
  transform: translateY(0) scaleX(1);
}

.sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

/* Section title ornament underline */
.section-title {
  display: inline-block;
  position: relative;
}

.section-title::after {
  content: '';
  position: absolute;
  left: 50%;
  transform: translateX(-50%) scaleX(0);
  transform-origin: center;
  bottom: -12px;
  width: 240px;
  height: 6px;
  border-radius: 999px;
  background: linear-gradient(90deg, rgba(255,238,153,1) 0%, rgba(255,200,80,1) 45%, rgba(255,150,40,1) 100%);
  box-shadow: 0 6px 18px rgba(255,170,50,0.18), 0 2px 6px rgba(255,200,120,0.06) inset;
  opacity: 0.0;
  transition: transform 320ms cubic-bezier(.2,.9,.2,1), opacity 220ms ease;
  pointer-events: none;
}

.section-title::before {
  /* soft blurred glow behind the bar */
  content: '';
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  bottom: -16px;
  width: 260px;
  height: 18px;
  border-radius: 999px;
  background: linear-gradient(90deg, rgba(255,238,153,0.14), rgba(255,200,80,0.12), rgba(255,150,40,0.08));
  filter: blur(8px);
  opacity: 0;
  transition: opacity 300ms ease;
  pointer-events: none;
}

.section-title:hover::after,
.section-title:focus::after,
.section-title[aria-current]:after {
  transform: translateX(-50%) scaleX(1);
  opacity: 1;
}

.section-title:hover::before,
.section-title:focus::before,
.section-title[aria-current]:before {
  opacity: 1;
}

/* subtle shimmer moving left-to-right when hovered */
@keyframes section-shimmer {
  0% { background-position: 0% 50%; }
  100% { background-position: 100% 50%; }
}

.section-title:hover::after {
  background-size: 200% 100%;
  animation: section-shimmer 1.6s linear infinite;
}

@media (max-width: 768px) {
  .section-title::after { width: 160px; bottom: -10px; }
  .section-title::before { width: 180px; bottom: -12px; }
}

@media (prefers-reduced-motion: reduce) {
  .section-title::after,
  .section-title::before {
    transition: none !important;
    animation: none !important;
  }
}

/* Active indicator for nav links (small animated underline) */
.nav-link::after {
  /* already defined for hover; ensure origin for active */
  transform-origin: center;
}

.nav-link[data-active='true']::after {
  transform: translateY(0) scaleX(1);
  opacity: 1;
  transition: transform 260ms cubic-bezier(.2,.9,.2,1), opacity 180ms ease;
}

/* Button micro-animation: subtle pulse/glow on hover and active press */
.btn-micro {
  transition: transform 160ms cubic-bezier(.2,.9,.2,1), box-shadow 220ms ease;
}
.btn-micro:hover {
  transform: translateY(-2px) scale(1.02);
  box-shadow: 0 14px 36px rgba(0,0,0,0.22), 0 4px 10px rgba(0,0,0,0.08) inset;
}
.btn-micro:active {
  transform: translateY(0) scale(0.995);
}

@media (max-width: 768px) {
  .section-title::after {
    width: 140px;
    bottom: -14px;
  }
}

/* Reveal-on-scroll utility */
.reveal {
  opacity: 0;
  transform: translateY(18px);
  transition: opacity 560ms cubic-bezier(.2,.9,.2,1), transform 560ms cubic-bezier(.2,.9,.2,1);
  will-change: opacity, transform;
}

.reveal--visible {
  opacity: 1;
  transform: translateY(0);
}

.reveal[data-delay="small"] { transition-delay: 80ms }
.reveal[data-delay="medium"] { transition-delay: 160ms }
.reveal[data-delay="large"] { transition-delay: 280ms }

/* Section divider: aurora style */
.section-divider { position: relative; height: 64px; opacity: 0; transform: translateY(10px); transition: opacity 420ms ease, transform 420ms cubic-bezier(.2,.9,.2,1); overflow: hidden; }
.section-divider--visible { opacity: 1; transform: translateY(0); }
.section-divider.aurora { filter: saturate(1.02) contrast(1); }
.section-divider .aurora-layer { position: absolute; left: -10%; right: -10%; height: 140%; top: -20%; opacity: 0.6; filter: blur(14px); transform: translateY(0) scale(1.02); transition: opacity 420ms ease, transform 420ms ease; will-change: transform, opacity; }
.section-divider .aurora-1 { background: radial-gradient(60% 40% at 20% 50%, rgba(255,220,140,0.12), transparent 65%), radial-gradient(50% 40% at 60% 60%, rgba(255,180,90,0.10), transparent 70%); animation: aurora-flow-1 12s ease-in-out infinite; }
.section-divider .aurora-2 { background: radial-gradient(60% 40% at 40% 50%, rgba(160,130,255,0.10), transparent 65%), radial-gradient(55% 42% at 80% 60%, rgba(100,200,255,0.08), transparent 70%); animation: aurora-flow-2 16s ease-in-out infinite; mix-blend-mode: screen; }
.section-divider .aurora-3 { background: radial-gradient(60% 40% at 70% 50%, rgba(255,240,200,0.10), transparent 65%), radial-gradient(45% 40% at 30% 60%, rgba(255,170,100,0.08), transparent 70%); animation: aurora-flow-3 18s ease-in-out infinite; }

@keyframes aurora-flow-1 { 0% { transform: translateY(6px) translateX(-6%) scale(1.02); } 50% { transform: translateY(-4px) translateX(6%) scale(1.02); } 100% { transform: translateY(6px) translateX(-6%) scale(1.02); } }
@keyframes aurora-flow-2 { 0% { transform: translateY(4px) translateX(4%) scale(1.01); } 50% { transform: translateY(-6px) translateX(-4%) scale(1.03); } 100% { transform: translateY(4px) translateX(4%) scale(1.01); } }
@keyframes aurora-flow-3 { 0% { transform: translateY(8px) translateX(2%) scale(1.00); } 50% { transform: translateY(-2px) translateX(-2%) scale(1.02); } 100% { transform: translateY(8px) translateX(2%) scale(1.00); } }

/* Parallax layer base */
.parallax-layer { transition: transform 220ms linear; will-change: transform; }

/* Section icon micro-animation */
.section-icon { display: inline-block; vertical-align: middle; margin-right: 10px; }
.section-icon.spark path { transition: transform 420ms cubic-bezier(.2,.9,.2,1), opacity 320ms ease; }
.section-icon.leaf path { transition: transform 520ms cubic-bezier(.2,.9,.2,1), opacity 320ms ease; }
.section-icon:hover { transform: translateY(-3px) scale(1.04); }

  /* Starfield: subtle twinkling stars for backgrounds */
  .starfield { position: absolute; left: 0; right: 0; bottom: 0; height: 70%; pointer-events: none; z-index: 18; overflow: visible; }

  /* soft nebula background for depth */
  .starfield::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(40% 30% at 30% 75%, rgba(255,230,180,0.06), transparent 15%), radial-gradient(50% 30% at 70% 85%, rgba(255,180,90,0.04), transparent 20%);
    pointer-events: none;
    mix-blend-mode: screen;
    z-index: 16;
  }

  .starfield .star { position: absolute; border-radius: 50%; background: radial-gradient(circle at 35% 35%, rgba(255,255,255,1), rgba(255,220,140,0.9)); filter: blur(0.6px); transform: translateZ(0) translateY(0); animation: star-rise var(--d, 8s) linear infinite; animation-delay: var(--delay, 0s); box-shadow: 0 0 var(--glow, 8px) rgba(255,220,140,0.08), 0 0 calc(var(--glow, 8px) / 2) rgba(255,245,200,0.06); }
  @keyframes star-rise { 0% { transform: translateY(8vh) scale(0.9); opacity: 0.02; } 12% { opacity: 0.22; } 85% { opacity: 0.22; } 100% { transform: translateY(-28vh) scale(1.08); opacity: 0.02; } }

  /* twinkle layer (subtle scaling) */
  .starfield .star::after { content: ''; position: absolute; inset: 0; border-radius: 50%; background: radial-gradient(circle at 35% 35%, rgba(255,255,255,0.95), rgba(255,220,140,0.55)); animation: star-twinkle 5.6s ease-in-out infinite; opacity: 0.75; mix-blend-mode: screen; }
  @keyframes star-twinkle { 0% { transform: scale(0.9); } 50% { transform: scale(1.18); } 100% { transform: scale(0.9); } }

  /* comet trails */
  .starfield .comet { position: absolute; width: calc(var(--size, 2px) * 8); height: 2px; background: linear-gradient(90deg, rgba(255,255,255,0.95), rgba(255,200,80,0.8), rgba(255,200,80,0.02)); filter: blur(3px) saturate(1.1); transform-origin: left center; opacity: 0; animation: comet-run var(--d, 10s) linear infinite; animation-delay: var(--delay, 0s); z-index: 20; border-radius: 12px; box-shadow: 0 6px 24px rgba(255,180,70,0.08); }
  @keyframes comet-run { 0% { transform: translateX(-8vw) rotate(-8deg) scaleX(0.2); opacity: 0; } 6% { opacity: 1; } 50% { transform: translateX(60vw) rotate(-8deg) scaleX(1); opacity: 0.95; } 100% { transform: translateX(120vw) rotate(-8deg) scaleX(1.2); opacity: 0; } }

  /* subtle spark accents (small crossing glints) */
  .starfield .spark { position: absolute; width: 6px; height: 6px; border-radius: 50%; background: radial-gradient(circle, rgba(255,255,255,1), rgba(255,220,140,0.9)); filter: blur(0.8px); opacity: 0.9; transform: translateZ(0) scale(0.8); animation: spark-pop 3.6s infinite ease-in-out; }
  @keyframes spark-pop { 0% { transform: scale(0.7) translateY(0); opacity: 0.3 } 40% { transform: scale(1.2) translateY(-6px); opacity: 1 } 100% { transform: scale(0.9) translateY(0); opacity: 0.3 } }

  @media (prefers-reduced-motion: reduce) { .starfield .star, .starfield .star::after, .starfield .comet, .starfield .spark { animation: none; opacity: 0.06 !important; } }

  /* Section-level sparks: thin streaks that cross diagonally (no horizontal bar) */
  /* section particles removed per user request */
  /* layout helper: ensure sections are positioned relative for correct absolute positioning */
  section { position: relative; }

  /* slightly increase vertical spacing between sections (a little extra breathing room) */
  section { padding-top: calc(5rem + 1rem); padding-bottom: calc(5rem + 1rem); }
  /* extra small margin between adjacent sections to avoid feeling cramped */
  section + section { margin-top: 1rem; }

  /* Soft fade edges to blend sections more naturally */
  .soft-fade::before,
  .soft-fade::after {
    content: '';
    position: absolute;
    left: 0;
    right: 0;
    height: 52px;
    pointer-events: none;
    z-index: 2;
  }
  .soft-fade::before { top: 0; background: linear-gradient(to bottom, rgba(0,0,0,0.28), rgba(0,0,0,0)); }
  .soft-fade::after { bottom: 0; background: linear-gradient(to top, rgba(0,0,0,0.22), rgba(0,0,0,0)); }

  /* Fluid section divider animations */
  .section-divider { overflow: visible; pointer-events: none; position: relative; }
  .section-divider svg { display: block; width: 100%; height: 80px; }
  .section-divider .wave-layer { transition: transform 420ms cubic-bezier(.2,.9,.2,1); transform-origin: center; }
  .section-divider .wave-layer-back { opacity: 0.6; transform: translateY(6px); }
  .section-divider .wave-layer-front { opacity: 1; transform: translateY(0); }

  /* subtle centered glow (no lateral sweep) to avoid horizontal bar — gentle, elegant motion */
  .section-divider::before {
    content: '';
    position: absolute;
    left: 0;
    right: 0;
    top: -6px;
    bottom: -6px;
    pointer-events: none;
    z-index: 20;
    background: radial-gradient(60% 30% at 50% 40%, rgba(255,245,200,0.10), rgba(255,210,120,0.06) 55%, transparent 72%);
    mix-blend-mode: screen;
    filter: blur(10px) saturate(1.02);
    opacity: 0;
    transform: translateY(0) scale(1);
    transition: opacity 320ms ease, transform 420ms ease;
  }

  /* when visible, animate the waves softly and fade in the centered glow */
  .section-divider--visible { opacity: 1; }
  .section-divider--visible .wave-layer-back { animation: wave-bob-slow 12s ease-in-out infinite; }
  .section-divider--visible .wave-layer-front { animation: wave-bob 8.2s ease-in-out infinite; }
  .section-divider--visible::before { opacity: 1; animation: subtle-shimmer 6.8s ease-in-out infinite; }

  /* subtle pulse under the front wave to increase perceived motion */
  .section-divider::after {
    content: '';
    position: absolute;
    left: 8%;
    right: 8%;
    top: 14px;
    height: 28px;
    pointer-events: none;
    z-index: 10;
    background: radial-gradient(60% 30% at 50% 20%, rgba(255,220,140,0.10), rgba(255,180,70,0.04) 50%, transparent 70%);
    filter: blur(14px);
    opacity: 0;
    transform: translateY(0);
    transition: opacity 420ms ease, transform 420ms ease;
  }
  .section-divider--visible::after { opacity: 1; animation: pulse-glow 8s ease-in-out infinite; }

  @keyframes pulse-glow { 0% { transform: translateY(0) scaleX(1); opacity: 0.12; } 50% { transform: translateY(-6px) scaleX(1.02); opacity: 0.22; } 100% { transform: translateY(0) scaleX(1); opacity: 0.12; } }

  @keyframes wave-bob { 0% { transform: translateY(0) scaleX(1); } 25% { transform: translateY(6px) scaleX(1.006); } 50% { transform: translateY(2px) scaleX(1); } 75% { transform: translateY(8px) scaleX(1.008); } 100% { transform: translateY(0) scaleX(1); } }

  @keyframes wave-bob-slow { 0% { transform: translateY(6px) scaleX(1); } 40% { transform: translateY(10px) scaleX(1.006); } 80% { transform: translateY(6px) scaleX(1); } 100% { transform: translateY(6px) scaleX(1); } }

  /* tiny centered shimmer — only opacity and slight vertical movement, no horizontal sweep */
  @keyframes subtle-shimmer { 0% { transform: translateY(0) scale(1); opacity: 0.06; } 50% { transform: translateY(-4px) scale(1.01); opacity: 0.12; } 100% { transform: translateY(0) scale(1); opacity: 0.06; } }

  /* soften and blur the gradient edge for a smoother fluid look */
  .section-divider .divider-path { filter: blur(8px); opacity: 0.98; transition: opacity 420ms ease, filter 420ms ease; }

  @media (prefers-reduced-motion: reduce) {
    .section-divider::before, .section-divider .wave-layer, .section-divider .divider-path { animation: none !important; transition: none !important; }
    .section-divider::before { opacity: 0 !important; }
  }

/* SectionDivider hidden for a more natural flow between sections */
.section-divider { display: none !important; }

/* Alternate divider: diagonal shimmer ribbon */
.section-divider-alt { position: relative; height: 64px; overflow: hidden; opacity: 0; transform: translateY(10px); transition: opacity 420ms ease, transform 420ms cubic-bezier(.2,.9,.2,1); }
.section-divider-alt--visible { opacity: 1; transform: translateY(0); }
.section-divider-alt .ribbon-bg { position: absolute; left: -10%; right: -10%; top: 0; bottom: 0; background: linear-gradient(100deg, rgba(18,18,22,0.0) 0%, rgba(255,210,140,0.08) 32%, rgba(255,180,90,0.10) 52%, rgba(18,18,22,0.0) 80%); transform: skewY(-4deg) translateY(12px); filter: blur(10px) saturate(1.02); }
.section-divider-alt .ribbon-glow { position: absolute; left: 12%; right: 12%; top: 16px; height: 32px; background: radial-gradient(40% 60% at 50% 50%, rgba(255,220,140,0.12), rgba(255,180,70,0.0)); filter: blur(12px); opacity: 0.9; animation: ribbon-breathe 10s ease-in-out infinite; }
@keyframes ribbon-breathe { 0% { transform: translateY(0) scaleX(1); opacity: 0.12; } 50% { transform: translateY(-6px) scaleX(1.04); opacity: 0.22; } 100% { transform: translateY(0) scaleX(1); opacity: 0.12; } }

/* Magic divider: animated gradient bed, bobbing wave, and comet streaks */
.section-divider-magic { position: relative; height: 80px; overflow: hidden; opacity: 0; transform: translateY(12px); transition: opacity 420ms ease, transform 420ms cubic-bezier(.2,.9,.2,1); }
.section-divider-magic--visible { opacity: 1; transform: translateY(0); }
.section-divider-magic .magic-bed { position: absolute; inset: 0; background:
  /* vertical degrade to bridge from darker codex into blog background */
  linear-gradient(to bottom, rgba(16,16,18,0.45), rgba(16,16,18,0.18), rgba(16,16,18,0.0)),
  radial-gradient(60% 50% at 30% 60%, rgba(255,210,140,0.08), transparent 70%),
  radial-gradient(60% 55% at 70% 40%, rgba(120,160,255,0.08), transparent 72%),
  linear-gradient(to right, rgba(18,18,22,0.0), rgba(255,190,100,0.06), rgba(18,18,22,0.0));
  filter: blur(10px) saturate(1.02) brightness(1.02);
}
.section-divider-magic .magic-wave { position: absolute; inset: 0; transform-origin: center; animation: magic-wave-bob 9s ease-in-out infinite; }
@keyframes magic-wave-bob { 0% { transform: translateY(2px) scaleX(1); } 50% { transform: translateY(-6px) scaleX(1.02); } 100% { transform: translateY(2px) scaleX(1); } }
.magic-comet { position: absolute; height: 2px; width: 120px; background: linear-gradient(90deg, rgba(255,255,255,0.0), rgba(255,240,180,0.95), rgba(255,190,90,0.08)); filter: blur(1.5px) saturate(1.08); border-radius: 12px; opacity: 0; }
.section-divider-magic--visible .magic-comet { animation: comet-fly 7.5s linear infinite; }
@keyframes comet-fly { 0% { transform: translateX(-20vw) translateY(10px) rotate(-6deg); opacity: 0; } 10% { opacity: 1; } 60% { opacity: 0.95; } 100% { transform: translateX(120vw) translateY(-6px) rotate(-6deg); opacity: 0; } }
.magic-comet.mc-1 { top: 22px; animation-delay: 0s; }
.magic-comet.mc-2 { top: 12px; animation-delay: 1.5s; }
.magic-comet.mc-3 { top: 36px; animation-delay: 3.2s; }
.magic-comet.mc-4 { top: 48px; animation-delay: 4.8s; }
.magic-comet.mc-5 { top: 28px; animation-delay: 6s; }
.magic-comet.mc-6 { top: 18px; animation-delay: 7.2s; }

/* Gradient bridge utility to strengthen vertical degrade at the start of a section */
.gradient-bridge-top { position: relative; }
.gradient-bridge-top::before {
  content: '';
  position: absolute;
  left: 0; right: 0; top: -80px; height: 160px;
  background: linear-gradient(to bottom, rgba(16,16,18,0.55), rgba(16,16,18,0.32) 35%, rgba(16,16,18,0.16) 65%, rgba(16,16,18,0.0));
  pointer-events: none; z-index: 1;
}

.codex-wrapper { position: relative; overflow: visible; max-width: none; }
/* Fix the Codex background video so it remains stable and doesn’t jump/zoom on tab changes */
.codex-bg {
  position: relative; /* scoped to section */
  z-index: 0;
  overflow: hidden;
  width: 100vw; /* ensure edge-to-edge */
}

/* Blurred poster backdrop to avoid black side bars while keeping main video/image object-contained */
.codex-bg::before {
  content: '';
  position: absolute;
  inset: 0;
  /* Soft neutral gradient backdrop to avoid hard bands while keeping depth */
  background: radial-gradient(120% 140% at 50% 60%, rgba(16,16,18,0.96) 0%, rgba(16,16,18,0.88) 40%, rgba(16,16,18,0.70) 62%, rgba(16,16,18,0.46) 78%, rgba(16,16,18,0.18) 100%);
  filter: none;
  transform: none;
  z-index: 0;
}

/* Subtle living glow behind the video for a more organic feel */
.codex-bg::after {
  content: '';
  position: absolute;
  inset: 0;
  background:
    radial-gradient(50% 40% at 30% 65%, rgba(255,210,140,0.06), transparent 70%),
    radial-gradient(60% 45% at 70% 45%, rgba(120,160,255,0.05), transparent 72%);
  mix-blend-mode: screen;
  opacity: 0.9;
  animation: codex-glow-drift 22s ease-in-out infinite;
  z-index: 2;
  pointer-events: none;
}

@keyframes codex-glow-drift {
  0% { transform: translateY(0) translateX(0) scale(1); opacity: 0.9; }
  50% { transform: translateY(-10px) translateX(8px) scale(1.02); opacity: 0.85; }
  100% { transform: translateY(0) translateX(0) scale(1); opacity: 0.9; }
}

/* Smooth top fade for Codex section so it blends naturally into previous section */
.codex-wrapper::before {
  content: '';
  position: absolute;
  left: 0; right: 0; top: -28px; height: 56px;
  background: linear-gradient(to bottom, rgba(0,0,0,0.16), rgba(0,0,0,0.0));
  z-index: 50; pointer-events: none;
}

/* Ensure codex section is visible in narrow viewports (Simple Browser) */
@media (max-height: 700px) {
  .codex-bg {
    min-height: 60vh;
  }
}
.codex-bg video {
  position: absolute;
  inset: 0; /* fill container */
  width: 100%;
  height: 100%;
  object-fit: cover; /* prefer cover to eliminate side gutters on ultra-wide */
  object-position: 50% 40%; /* frame slightly higher so crossfade feels from top */
  display: block;
  z-index: 1;
  contain: paint;
  will-change: opacity; /* avoid transform re-triggers on tab switches */
  pointer-events: none; /* allow CTA clicks above */
}
.codex-cover video { object-fit: cover !important; }
.hero-like-video { filter: brightness(0.36) saturate(0.9) contrast(0.9) blur(0px); }
.codex-bg-overlay { position: absolute; left: 0; right: 0; top: 0; bottom: 0; background-color: rgba(0,0,0,0.70); z-index: 2; pointer-events: none; }
.codex-content { position: relative; z-index: 40; }

/* Footer links: prevent inherited underline, show only on hover with primary color */
footer a { text-decoration: none; }
footer a:hover { text-decoration: underline; text-underline-offset: 4px; }

/* Reduced card sizing for Codex section so a video background fits better */
.codex-card { padding: 0.5rem; border-radius: 0.75rem; }
.codex-card .w-16.h-16 { width: 3.25rem; height: 3.25rem; }
.codex-card h3 { font-size: 1rem; margin-bottom: 0.35rem; }
.codex-card p, .codex-card h4 { font-size: 0.9rem; margin-bottom: 0.35rem; }
.codex-card .space-y-4 > * { margin-top: 0.35rem; margin-bottom: 0.35rem; }

/* Add extra padding so content has breathing room above the fixed video */
.codex-wrapper { padding-bottom: 10rem; }

/* CTA overlay centered above video */
.codex-cta-over { position: absolute; left: 50%; transform: translate(-50%, 0); bottom: 4.5rem; z-index: 140; }

.codex-cta-over .btn-gold {
  padding-left: 4rem; padding-right: 4rem; padding-top: 1rem; padding-bottom: 1rem;
  font-size: 1.125rem; /* ~18px */
  line-height: 1;
  border-radius: 0.75rem;
  box-shadow: 0 22px 56px rgba(255,180,70,0.14);
  transition: transform 180ms cubic-bezier(.2,.9,.2,1), box-shadow 240ms ease, filter 220ms ease, text-shadow 180ms ease;
  text-shadow: 0 0 6px rgba(255,230,140,0.25);
}

.codex-cta-over .btn-gold:hover {
  transform: translateY(-6px) scale(1.06);
  box-shadow: 0 34px 88px rgba(255,190,80,0.28), 0 10px 28px rgba(255,160,50,0.06) inset;
  filter: saturate(1.08) brightness(1.03);
  text-shadow: 0 0 18px rgba(255,245,180,0.95), 0 6px 28px rgba(255,180,70,0.12);
}

/* Full-bleed helper to stretch a child to viewport width inside a centered container */
.full-bleed { position: relative; left: 50%; right: 50%; margin-left: -50vw; margin-right: -50vw; width: 100vw; max-width: 100vw; }

/* optional stronger focus/glow for accessibility */
.codex-cta-over .btn-gold:focus-visible {
  outline: none;
  box-shadow: 0 0 0 4px rgba(255,220,140,0.06), 0 36px 96px rgba(255,190,80,0.22);
}

/* Static bottom shadow to anchor the transition into next section */
.codex-bottom-shadow {
  position: absolute; inset: 0; z-index: 26; pointer-events: none;
  background:
    linear-gradient(to bottom, rgba(0,0,0,0.0) 55%, rgba(0,0,0,0.22) 78%, rgba(0,0,0,0.42)),
    radial-gradient(70% 40% at 50% 85%, rgba(255,210,140,0.08), transparent 70%);
}

/* Animated darkening strip for title/subtitle area that sits above the video but below content */
/* codex-title-overlay removed in favor of full-bleed overlay + particles like HeroSection */

/* Gentle section transition: blend gradient and slight fade */
.section-transition { position: relative; }
.section-transition::before {
  content: '';
  position: absolute;
  left: 0; right: 0; top: -2.5rem; height: 2.5rem;
  background: linear-gradient(to bottom, rgba(6,8,12,0.9), rgba(6,8,12,0));
  pointer-events: none;
  z-index: 30;
  opacity: 0;
  transition: opacity 420ms ease;
}
.section-transition.revealed::before { opacity: 1; }

/* Fallback poster image when video isn't available: show behind content and hidden when video plays */
.codex-poster {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  z-index: 0;
  display: block;
}
/* remove conflicting video/poster overrides to respect component classes */

/* replicate the hero title glow for Codex section */
.codex-content .section-title {
  position: relative;
}
.codex-content .section-title::after {
  content: '';
  position: absolute;
  left: 50%;
  transform: translateX(-50%) scaleX(0);
  bottom: -12px;
  width: 200px;
  height: 6px;
  border-radius: 999px;
  background: linear-gradient(90deg, rgba(255,238,153,0.95), rgba(255,200,80,0.95));
  box-shadow: 0 6px 18px rgba(255,170,50,0.12);
  opacity: 0;
  transition: transform 320ms cubic-bezier(.2,.9,.2,1), opacity 220ms ease;
}
.codex-content .section-title:hover::after { transform: translateX(-50%) scaleX(1); opacity: 1; }

/* No scale on mobile to avoid zoom effect during layout shifts */
@media (max-width: 768px) { .codex-bg video { transform: translate(-50%, -50%); } }

/* Map background wrapper for WorldMap component */
.map-bg { position: relative; overflow: hidden; }
.map-bg img { display: block; width: 100%; height: 100%; object-fit: cover; }
.map-bg::after { content: ''; position: absolute; inset: 0; background: rgba(0,0,0,0.28); pointer-events: none; z-index: 0; }

/* Map editor modal overrides: ensure it's interactive and sits above background overlays */
.map-editor-modal { position: absolute; inset: 0; z-index: 9999; display: flex; align-items: center; justify-content: center; pointer-events: auto; }
.map-editor { display: flex; gap: 12px; width: calc(100% - 4rem); max-width: 1100px; pointer-events: auto; }
.map-editor-sidebar { pointer-events: auto; }
.map-editor-canvas { flex: 1; position: relative; pointer-events: auto; height: 640px; background: rgba(8,8,12,0.6); border-radius: 8px; overflow: hidden; }
.map-editor-canvas-inner { position: relative; width: 100%; height: 100%; user-select: none; }
.map-editor-svg { width: 100%; height: 100%; }
.editor-marker { width: 18px; height: 18px; cursor: grab; }
.editor-marker .marker-dot { width: 12px; height: 12px; border-radius: 999px; background: linear-gradient(180deg,#ffd77a,#ffb94a); border: 2px solid rgba(40,10,0,0.2); box-shadow: 0 6px 20px rgba(0,0,0,0.32); }
.map-editor-masks path { pointer-events: none; }

/* overlay badges used to position labels on the map */
/* overlay badges removed */


/* --- Codex crossfade system --- */
.codex-crossfade {
  /* fade progress: 0 = video fully visible; 1 = video fully faded into gradient */
  --codex-fade: 0;
  --codex-overlayOpacity: 0.75; /* dynamically updated by JS */
  --codex-noiseOpacity: 0.03;   /* dynamically updated by JS */
}

.codex-video { opacity: calc(1 - var(--codex-fade)); transition: opacity 520ms cubic-bezier(.2,.9,.2,1); }
.codex-dark-overlay { background-color: rgba(0,0,0,var(--codex-overlayOpacity)); transition: background-color 520ms cubic-bezier(.2,.9,.2,1); }

/* Themed gradient bed (revealed as video fades out) */
.codex-crossfade-bed {
  opacity: calc(0.85 * var(--codex-fade));
  transition: opacity 520ms cubic-bezier(.2,.9,.2,1), filter 520ms cubic-bezier(.2,.9,.2,1);
  background:
    radial-gradient(90% 70% at 50% 60%, rgba(22,22,26,0.92), rgba(18,18,22,0.90) 40%, rgba(16,16,18,0.72) 70%, rgba(12,12,14,0.48) 90%, rgba(10,10,12,0.28) 100%),
    linear-gradient(180deg, rgba(255,210,140,0.10), rgba(120,160,255,0.10) 40%, rgba(255,190,120,0.06) 70%, rgba(16,16,18,0.0)),
    radial-gradient(40% 40% at 30% 70%, rgba(255,210,140,0.10), transparent 70%),
    radial-gradient(40% 40% at 70% 40%, rgba(120,160,255,0.10), transparent 70%);
  filter: saturate(1.02) contrast(1.02);
}

/* Fine noise to avoid banding in gradients (tiny PNG/AVIF could be better; here CSS-generated) */
.codex-noise {
  opacity: var(--codex-noiseOpacity);
  transition: opacity 520ms cubic-bezier(.2,.9,.2,1);
  background-image:
    radial-gradient(1px 1px at 20% 30%, rgba(255,255,255,0.08), transparent 60%),
    radial-gradient(1px 1px at 70% 40%, rgba(255,255,255,0.07), transparent 60%),
    radial-gradient(1px 1px at 40% 80%, rgba(255,255,255,0.06), transparent 60%),
    radial-gradient(1px 1px at 60% 60%, rgba(255,255,255,0.07), transparent 60%);
  background-size: 180px 180px, 220px 220px, 160px 160px, 260px 260px;
  mix-blend-mode: soft-light;
}

/* Soft mask on edges to prevent a hard line while transitioning */
.codex-mask {
  position: absolute; inset: 0; z-index: 31; pointer-events: none;
  background:
    linear-gradient(to bottom, rgba(0,0,0,0.22), rgba(0,0,0,0.10) 22%, rgba(0,0,0,0.0) 48%),
    linear-gradient(to top, rgba(0,0,0,0.18), rgba(0,0,0,0.08) 22%, rgba(0,0,0,0.0) 48%);
  opacity: calc(0.55 - 0.35 * var(--codex-fade));
  transition: opacity 520ms cubic-bezier(.2,.9,.2,1);
}

@media (prefers-reduced-motion: reduce) {
  .codex-video, .codex-crossfade-bed, .codex-noise, .codex-dark-overlay { transition: none !important; }
}



